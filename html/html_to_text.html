<!--
category: data
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to Text</title>
    <style>
    :root {
        --primary: #1a7f64;
        --primary-hover: #156b54;
        --bg: #fafaf9;
        --surface: #ffffff;
        --text: #1c1917;
        --text-muted: #78716c;
        --border: #d6d3d1;
        --accent: #f5f5f4;
    }
    * { box-sizing: border-box; }
    body {
        font-family: "IBM Plex Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        padding: 24px;
        line-height: 1.6;
        color: var(--text);
        background: var(--bg);
    }
    h1 {
        font-weight: 600;
        font-size: 1.75rem;
        margin-bottom: 0.5rem;
        letter-spacing: -0.025em;
    }
    .subtitle {
        color: var(--text-muted);
        margin-bottom: 2rem;
        font-size: 1rem;
    }
    .panel {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1.25rem;
        margin-bottom: 1rem;
    }
    label {
        display: block;
        font-weight: 500;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
    }
    textarea {
        width: 100%;
        font-size: 14px;
        font-family: "IBM Plex Mono", "SF Mono", Consolas, monospace;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 6px;
        resize: vertical;
        background: var(--accent);
        color: var(--text);
        line-height: 1.5;
    }
    textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(26, 127, 100, 0.1);
    }
    #input-html {
        min-height: 200px;
    }
    #output-text {
        min-height: 200px;
        background: var(--surface);
    }
    .actions {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        margin: 1rem 0;
    }
    button {
        font-size: 16px;
        font-family: inherit;
        font-weight: 500;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background: var(--primary);
        color: white;
        transition: background 0.15s ease;
    }
    button:hover {
        background: var(--primary-hover);
    }
    button:active {
        transform: translateY(1px);
    }
    button.secondary {
        background: var(--accent);
        color: var(--text);
        border: 1px solid var(--border);
    }
    button.secondary:hover {
        background: var(--border);
    }
    .error {
        color: #b91c1c;
        background: #fef2f2;
        padding: 12px;
        border-radius: 6px;
        border: 1px solid #fecaca;
        display: none;
        margin-bottom: 1rem;
    }
    .success {
        color: #15803d;
        background: #f0fdf4;
        padding: 12px;
        border-radius: 6px;
        border: 1px solid #bbf7d0;
        display: none;
        margin-bottom: 1rem;
    }
    .stats {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-top: 0.5rem;
    }
    .options {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
    }
    .option {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    .option input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--primary);
    }
    footer {
        margin-top: 48px;
        padding-top: 24px;
        border-top: 1px solid var(--border);
        font-size: 0.875rem;
        color: var(--text-muted);
        text-align: center;
    }
    footer a {
        color: var(--primary);
        text-decoration: none;
    }
    footer a:hover {
        text-decoration: underline;
    }
    footer p {
        margin: 0.5rem 0;
    }

    @media (max-width: 600px) {
        body { padding: 16px; }
        .actions { flex-direction: column; }
        button { width: 100%; }
    }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <h1>HTML to Text</h1>
    <p class="subtitle">Paste HTML and extract readable plain text. Runs entirely in your browser.</p>

    <div id="error" class="error"></div>
    <div id="success" class="success"></div>

    <main>
        <div class="panel">
            <label for="input-html">Paste HTML</label>
            <textarea id="input-html" placeholder="<html>&#10;  <body>&#10;    <h1>Hello World</h1>&#10;    <p>Paste your HTML here...</p>&#10;  </body>&#10;</html>"></textarea>
        </div>

        <div class="options">
            <label class="option">
                <input type="checkbox" id="opt-collapse-whitespace" checked>
                Collapse whitespace
            </label>
            <label class="option">
                <input type="checkbox" id="opt-preserve-links" checked>
                Preserve links as [text](url)
            </label>
        </div>

        <div class="actions">
            <button id="btn-convert">Convert to Text</button>
            <button id="btn-paste" class="secondary">Paste from Clipboard</button>
            <button id="btn-clear" class="secondary">Clear</button>
        </div>

        <div class="panel">
            <label for="output-text">Plain Text Output</label>
            <textarea id="output-text" readonly placeholder="Converted text will appear here..."></textarea>
            <div id="stats" class="stats"></div>
        </div>

        <div class="actions">
            <button id="btn-copy">Copy to Clipboard</button>
        </div>
    </main>

    <footer>
        <p>Made by Ricardo Decal. Updated 2025-12-20</p>
        <p>
            <a href="https://tools.ricardodecal.com">Home</a> |
            <a href="https://github.com/ricardodecal/tools/blob/main/html/html_to_text.html">View source</a>
        </p>
        <p><a href="https://github.com/ricardodecal/tools/blob/main/LICENSE">Apache 2.0 License</a></p>
    </footer>

    <script type="module">
document.addEventListener('DOMContentLoaded', () => {
    const inputHtml = document.getElementById('input-html');
    const outputText = document.getElementById('output-text');
    const errorDiv = document.getElementById('error');
    const successDiv = document.getElementById('success');
    const statsDiv = document.getElementById('stats');

    const btnConvert = document.getElementById('btn-convert');
    const btnPaste = document.getElementById('btn-paste');
    const btnClear = document.getElementById('btn-clear');
    const btnCopy = document.getElementById('btn-copy');

    const optCollapseWhitespace = document.getElementById('opt-collapse-whitespace');
    const optPreserveLinks = document.getElementById('opt-preserve-links');

    function showError(msg) {
        errorDiv.textContent = msg;
        errorDiv.style.display = 'block';
        successDiv.style.display = 'none';
    }

    function showSuccess(msg) {
        successDiv.textContent = msg;
        successDiv.style.display = 'block';
        errorDiv.style.display = 'none';
        setTimeout(() => {
            successDiv.style.display = 'none';
        }, 2500);
    }

    function clearMessages() {
        errorDiv.style.display = 'none';
        successDiv.style.display = 'none';
    }

    function extractText(html, options) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');

        // Remove script, style, and other non-content elements
        const removeSelectors = ['script', 'style', 'noscript', 'template', 'svg', 'head'];
        removeSelectors.forEach(sel => {
            doc.querySelectorAll(sel).forEach(el => el.remove());
        });

        let text;

        if (options.preserveLinks) {
            // Walk the DOM and convert links to markdown-style
            text = extractWithLinks(doc.body);
        } else {
            text = doc.body?.textContent || doc.documentElement?.textContent || '';
        }

        if (options.collapseWhitespace) {
            // Collapse multiple spaces/tabs to single space
            text = text.replace(/[ \t]+/g, ' ');
            // Collapse multiple newlines to double newline
            text = text.replace(/\n{3,}/g, '\n\n');
            // Trim each line
            text = text.split('\n').map(line => line.trim()).join('\n');
            // Remove leading/trailing whitespace
            text = text.trim();
        }

        return text;
    }

    function extractWithLinks(node) {
        if (!node) return '';

        let result = '';

        for (const child of node.childNodes) {
            if (child.nodeType === Node.TEXT_NODE) {
                result += child.textContent;
            } else if (child.nodeType === Node.ELEMENT_NODE) {
                const tagName = child.tagName.toLowerCase();

                // Block elements - add newlines
                const blockElements = ['p', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                                       'li', 'tr', 'br', 'hr', 'blockquote', 'pre',
                                       'article', 'section', 'header', 'footer', 'nav'];

                if (tagName === 'br') {
                    result += '\n';
                } else if (tagName === 'hr') {
                    result += '\n---\n';
                } else if (tagName === 'a') {
                    const href = child.getAttribute('href');
                    const linkText = extractWithLinks(child);
                    if (href && href !== linkText && !href.startsWith('#') && !href.startsWith('javascript:')) {
                        result += `[${linkText.trim()}](${href})`;
                    } else {
                        result += linkText;
                    }
                } else if (blockElements.includes(tagName)) {
                    result += '\n' + extractWithLinks(child) + '\n';
                } else {
                    result += extractWithLinks(child);
                }
            }
        }

        return result;
    }

    function updateStats(text) {
        if (!text) {
            statsDiv.textContent = '';
            return;
        }
        const chars = text.length;
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        const lines = text.split('\n').length;
        statsDiv.textContent = `${chars.toLocaleString()} characters · ${words.toLocaleString()} words · ${lines.toLocaleString()} lines`;
    }

    function convert() {
        clearMessages();
        const html = inputHtml.value.trim();

        if (!html) {
            showError('Please paste some HTML to convert.');
            return;
        }

        try {
            const options = {
                collapseWhitespace: optCollapseWhitespace.checked,
                preserveLinks: optPreserveLinks.checked
            };

            const text = extractText(html, options);
            outputText.value = text;
            updateStats(text);
        } catch (err) {
            showError(`Conversion failed: ${err.message}`);
        }
    }

    btnConvert.addEventListener('click', convert);

    btnPaste.addEventListener('click', async () => {
        clearMessages();
        try {
            const text = await navigator.clipboard.readText();
            inputHtml.value = text;
            showSuccess('Pasted from clipboard');
        } catch (err) {
            showError('Failed to read clipboard. Please paste manually (Ctrl+V / Cmd+V).');
        }
    });

    btnClear.addEventListener('click', () => {
        clearMessages();
        inputHtml.value = '';
        outputText.value = '';
        statsDiv.textContent = '';
    });

    btnCopy.addEventListener('click', async () => {
        clearMessages();
        const text = outputText.value;
        if (!text) {
            showError('No text to copy. Convert some HTML first.');
            return;
        }

        try {
            await navigator.clipboard.writeText(text);
            showSuccess('Copied to clipboard!');
        } catch (err) {
            showError('Failed to copy to clipboard.');
        }
    });

    // Auto-convert on paste into input
    inputHtml.addEventListener('paste', () => {
        setTimeout(convert, 50);
    });

    // Keyboard shortcut: Enter to convert
    inputHtml.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
            e.preventDefault();
            convert();
        }
    });
});
    </script>
</body>
</html>
